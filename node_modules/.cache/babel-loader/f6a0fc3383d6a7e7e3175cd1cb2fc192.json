{"ast":null,"code":"import _toConsumableArray from\"/Users/owner/Desktop/finalprojects/MyStagram/MyFront-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _defineProperty from\"/Users/owner/Desktop/finalprojects/MyStagram/MyFront-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/Users/owner/Desktop/finalprojects/MyStagram/MyFront-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/owner/Desktop/finalprojects/MyStagram/MyFront-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/owner/Desktop/finalprojects/MyStagram/MyFront-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/owner/Desktop/finalprojects/MyStagram/MyFront-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/owner/Desktop/finalprojects/MyStagram/MyFront-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React from\"react\";import{match}from'react';import\"./css/HomeContainer.css\";import Postcard from\"./components/PostCard\";import NewPostCard from\"./components/NewPostCard\";import Follows from'./components/Follows';import{getFollows,createFollow,deleteFollow}from'./redux/actions/FollowActions';import{connect}from'react-redux';import{getPost,editCaption}from'./redux/actions/PostActions';import{fetchUser,fetchAllUsers}from'./redux/actions/UserActions';import{addComment,deleteComment}from'./redux/actions/CommentsActions';import{changeLike}from'./redux/actions/PostActions';import{logout,notRequesting}from'./redux/actions/LoginActions';import ProfileCard from'./components/ProfilePostCard';import Loader from'./components/loader';import Bio from'./components/UserBio';var HomeContainer=/*#__PURE__*/function(_React$Component){_inherits(HomeContainer,_React$Component);function HomeContainer(){var _getPrototypeOf2;var _this;_classCallCheck(this,HomeContainer);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(HomeContainer)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.state={showCommentField:false,comment:\"\",post_id:\"\",Picture:\"\",caption:\"\",likes:0,page:\"thePost\",likedPosts:[],postRecieveingComment:null,requesting:false,showingUserId:null,showingOne:false,showOneBio:false,postToDelete:0,show_x:false};_this.submitComment=function(postId){var _this$props=_this.props,userid=_this$props.userid,addComment=_this$props.addComment,user=_this$props.user,requestedPost=_this$props.requestedPost;var userId=_this.state.userId;var body={post_id:postId,content:_this.state.comment,followee_id:userid};addComment(body);_this.resetCommentLength();};_this.postToCommentOn=function(id){_this.setState({postRecieveingComment:id});};_this.resetCommentLength=function(){_this.setState({comment:\"\",postRecieveingComment:null});};_this.handleComment=function(e){console.log(_this.state.comment,_this.state.postId);_this.setState(_defineProperty({},e.target.name,e.target.value));};_this.deleteComment=function(com){var deleteComment=_this.props.deleteComment;// console.log(com.id, com.post_id, com.followee_id, com.content)\ndeleteComment(com.id,com.post_id,com.followee_id,com.content);};_this.getCapField=function(){_this.setState({editingCaption:!_this.state.editingCaption});};_this.handleEditSubmit=function(id){_this.props.editCaption(id,_this.state.comment);_this.setState({comment:\"\"});_this.getCapField();};_this.showCommentField=function(){return _this.setState({showCommentField:!_this.state.showCommentField});};_this.handleLikes=function(id,likes){var likedPosts=_this.state.likedPosts;if(likedPosts.includes(id)){_this.deleteLike(id,likes);var likesArr=likedPosts.filter(function(pId){return pId!==id;});_this.setState({likedPosts:likesArr});}else{_this.addLike(id,likes);var newLikes=[].concat(_toConsumableArray(likedPosts),[id]);_this.setState({likedPosts:newLikes});}};_this.addLike=function(id,like){// this.setState({ liked: !this.state.liked })\nvar numLikes=like+1;_this.props.changeLike(id,numLikes,\"add\");};_this.deleteLike=function(id,like){// this.setState({ liked: !this.state.liked })\nvar numLikes=like-1;_this.props.changeLike(id,numLikes,\"\");};_this.thePost=function(){var _this$props2=_this.props,posts=_this$props2.posts,users=_this$props2.users,history=_this$props2.history;var _this$state=_this.state,comment=_this$state.comment,showCommentField=_this$state.showCommentField,editingCaption=_this$state.editingCaption,likedPosts=_this$state.likedPosts,postToCommentOn=_this$state.postToCommentOn,postRecieveingComment=_this$state.postRecieveingComment;return posts&&posts.length>0?posts.map(function(post){return React.createElement(Postcard,{users:users,post:post,history:history,commentLen:comment.length,toggleCommentField:_this.showCommentField,commentFieldStatus:showCommentField,yourField:postRecieveingComment,post2comment:_this.postToCommentOn,id:post.id,resetComment:_this.resetCommentLength,submitComment:function submitComment(){return _this.submitComment(post.id,post.userId);},handleComment:_this.handleComment,handleLikes:_this.handleLikes,getCapEditField:_this.getCapField,editCapStatus:editingCaption,submitCapEdit:_this.handleEditSubmit,addLike:_this.addLike,disLike:_this.deleteLike,liked:likedPosts,commentors:_this.theUsers,deleteComment:_this.deleteComment,showThisUser:_this.startShowingOneUser});}):console.log(\"The Post didnt work, here are the props:\",_this.props);};_this.handleNewPostClick=function(){_this.setState({newPost:!_this.state.newPost});};_this.theNewPostCard=function(props){var userid=_this.props.userid;return React.createElement(NewPostCard,{back:_this.returnToThePost});};_this.myProfile=function(){_this.props.history.push('/profile');};_this.returnToThePost=function(){_this.setState({page:\"thePost\",showingOne:false});};_this.handleNewPost=function(e){_this.setState(_defineProperty({},e.target.name,e.target.value));};_this.pageToRender=function(){var showingUserId=_this.state.showingUserId;switch(_this.state.page){case\"thePost\":return _this.thePost();case\"newPost\":return _this.theNewPostCard();case\"profile\":return _this.myProfile();case\"show one\":return _this.showOneUser(showingUserId);}};_this.startShowingOneUser=function(id){_this.setState({showingUserId:id,page:\"show one\",showingOne:!_this.state.showing});};_this.showOneUser=function(id){var _this$props3=_this.props,users=_this$props3.users,posts=_this$props3.posts,name=_this$props3.name;var theUser=users.find(function(user){return user.id===id;});console.log(\"The one user stuff:\",theUser);var userPost=posts.filter(function(post){return post.user_id===theUser.id;});return _this.showOneUsersPost(userPost);};_this.showOneUsersPost=function(post){var _this$state2=_this.state,likedPosts=_this$state2.likedPosts,comment=_this$state2.comment,post_id=_this$state2.post_id;var _this$props4=_this.props,name=_this$props4.name,users=_this$props4.users,userid=_this$props4.userid;return post.map(function(p){return React.createElement(ProfileCard,{post:p,user_id:p.user_id,users:users,name:name,pic:p.pic,id:p.id,likedPosts:likedPosts,comment:comment,handleLike:_this.handleLikes,setId:_this.setIdForPostToBeDeleted,handleComment:_this.handleComment,postCommId:post_id,currentUserId:userid,submitComment:_this.submitComment,resetComment:_this.resetCommentLength,commentState:_this.state.comment});});};_this.showOneUserBio=function(){var users=_this.props.users;var showingUserId=_this.state.showingUserId;var theUser=users.find(function(user){return user.id===showingUserId;});return React.createElement(Bio,{user:theUser.username,pic:theUser.picture,bio:theUser.bio,city:theUser.city,state:theUser.state,home:_this.returnToThePost});};_this.appLogout=function(){var logout=_this.props.logout;logout();localStorage.clear();localStorage.length===0&&_this.returnToLogoutPage();};_this.returnToLogoutPage=function(){var _this$props5=_this.props,requestedLogin=_this$props5.requestedLogin,logout=_this$props5.logout;logout();_this.props.history.push('/');};_this.theUsers=function(){var users=_this.props.users;var commentor={};if(!!users){_this.props.users.forEach(function(user){return commentor[user.id]=user.username;});return commentor;}};_this.followeeIds=function(){// EVERYONE WHO IS FOLLOWED\nvar foll=_this.props.follows.map(function(f){return f.followee_id;});var followees=_toConsumableArray(new Set(foll));// deletes/ filters duplicates out of arrays\nreturn followees;};_this.theFollow=function(ErId,EeId){return _this.props.follows.find(function(f){return f.follower_id===ErId&&f.followee_id===EeId;}).id;};_this.whoImFollowing=function(){var _this$props6=_this.props,follows=_this$props6.follows,userid=_this$props6.userid,users=_this$props6.users;var peepsImFollowing=users.filter(function(u){return follows.filter(function(f){return f.follower_id===userid&&f.followee_id===u.id;});});return peepsImFollowing;};_this.whoImNotFollowing=function(){var _this$props7=_this.props,follows=_this$props7.follows,userid=_this$props7.userid,users=_this$props7.users;var peepsImFollowing=users.filter(function(u){return follows.map(function(f){return f.follower_id!==userid&&f.followee_id===u.id;});});return peepsImFollowing;};_this.friends=function(){var _this$props8=_this.props,follows=_this$props8.follows,userid=_this$props8.userid,users=_this$props8.users,deleteFollow=_this$props8.deleteFollow,user=_this$props8.user;var friendsArr=follows.filter(function(f){return f.follower_id===userid;}).map(function(f){return f.followee_id;});var theFriends=friendsArr.map(function(f){return users.find(function(user){return user.id===f;});});if(theFriends.length>0){return theFriends.map(function(f){return React.createElement(\"div\",null,\" \",React.createElement(\"img\",{src:f.picture,className:\"friends-or-not-image\",onClick:function onClick(){return _this.startShowingOneUser(f.id);}}),\" \",React.createElement(\"br\",null),React.createElement(\"span\",{className:\"friends-or-not-name\",id:f.id,onClick:function onClick(){return deleteFollow(_this.theFollow(userid,f.id));}},\"\".concat(f.username,\" \\uD835\\uDEA1\")),\" \");});}else{return React.createElement(\"div\",{className:\"make-some-friends\"},React.createElement(\"p\",null,\"\\u2B05\\uFE0F Hey \".concat(user,\", Make Some \\u2B05\\uFE0F New Friends!\"),\" \"));}};_this.Suggestedfriends=function(){var _this$props9=_this.props,createFollow=_this$props9.createFollow,userid=_this$props9.userid,users=_this$props9.users,follows=_this$props9.follows;var allButMe=users.filter(function(user){return user.id!==userid;});var nonfriendsArr=follows.filter(function(f){return f.follower_id!==userid;}).map(function(f){return f.followee_id;});var friendsArr=follows.filter(function(f){return f.follower_id===userid;}).map(function(f){return f.followee_id;});var usersSinFollowers=allButMe.filter(function(u){return!_this.followeeIds().includes(u.id);});var nonFollowers=allButMe.filter(function(u){return nonfriendsArr.includes(u.id)&&!friendsArr.includes(u.id);});var tempArr=[].concat(_toConsumableArray(nonFollowers),_toConsumableArray(usersSinFollowers));var whoImNotFollowing=_toConsumableArray(new Set(tempArr));return whoImNotFollowing.map(function(f){return React.createElement(\"div\",null,\" \",React.createElement(\"img\",{src:f.picture,className:\"friends-or-not-image\",onClick:function onClick(){_this.startShowingOneUser(f.id);}}),\" \",React.createElement(\"br\",null),React.createElement(\"span\",{className:\"friends-or-not-name\",onClick:function onClick(){return createFollow(f.id,userid);},id:f.id},\" \".concat(f.username,\" \\u2713\")));});};_this.setIdForPostToBeDeleted=function(id){_this.setState({postToDelete:id});_this.showDelete_x();console.log(_this.state.postToDelete);};_this.showDelete_x=function(){_this.setState({show_x:!_this.state.show_x});};return _this;}_createClass(HomeContainer,[{key:\"componentDidMount\",value:function componentDidMount(){var _this$props10=this.props,getPost=_this$props10.getPost,fetchAllUsers=_this$props10.fetchAllUsers,getFollows=_this$props10.getFollows;getPost();fetchAllUsers();getFollows();console.log(\"HOME CONTAINER\");var history=this.props.history;!localStorage.token&&history.push('/');}// COMMENTS //\n},{key:\"render\",value:function render(){var _this2=this;var _this$props11=this.props,fposts=_this$props11.fposts,user=_this$props11.user,userId=_this$props11.userId,history=_this$props11.history,requestedLogin=_this$props11.requestedLogin,picture=_this$props11.picture;var _this$state3=this.state,showingOne=_this$state3.showingOne,showingUserId=_this$state3.showingUserId;this.theUsers();this.followeeIds();this.whoImFollowing();return React.createElement(\"div\",{className:\"Home-Container\"},React.createElement(Follows,null),React.createElement(\"nav\",{className:\"Homepage-nav\"},React.createElement(\"ul\",null,React.createElement(\"li\",{id:\"jays-gram\",onClick:function onClick(){return _this2.returnToThePost();}},React.createElement(\"span\",null,this.props.user,\"s'taGram \"),React.createElement(\"p\",{onClick:this.appLogout,className:\"logout\"},\" logout  \")),React.createElement(\"li\",null,React.createElement(\"p\",{className:\"camera\",id:this.state.id,onClick:function onClick(){return _this2.setState({page:\"newPost\"});}},\" \\uD83D\\uDCF8 \")),React.createElement(\"li\",{className:\"thumbnail\",onClick:function onClick(){return _this2.setState({page:\"profile\"});}},React.createElement(\"img\",{src:picture,id:\"thumbnail\"}),\" \"))),React.createElement(\"div\",{className:!localStorage.token?\"loading \":\"Home-Content\"},React.createElement(\"div\",{className:\"sugested-friends\"},!showingOne?React.createElement(\"span\",{className:\"friends-and-suggested-headers\"},\" Suggested\"):null,!showingOne?this.Suggestedfriends():this.showOneUserBio()),!showingOne?React.createElement(\"div\",{className:\"friends\"},React.createElement(\"span\",{className:\"friends-and-suggested-headers\"},\"Friends\"),this.friends()):null,this.pageToRender(),this.state.page!==\"newPost\"?React.createElement(\"div\",{className:\"Home-footer\"},\"Copyright \\xA9 2019 Jaystagram\"):React.createElement(React.Fragment,null)));}}]);return HomeContainer;}(React.Component);var mapStateToProps=function mapStateToProps(state){return{user:state.users.username,userid:state.users.id,picture:state.users.picture,users:state.users.all,posts:state.post.posts,requestedPost:state.post.requested,requestedLogin:state.login.requested,follows:state.follows.follows,name:state.users.usersObj};};export default connect(mapStateToProps,{getFollows:getFollows,getPost:getPost,fetchAllUsers:fetchAllUsers,fetchUser:fetchUser,addComment:addComment,editCaption:editCaption,changeLike:changeLike,logout:logout,notRequesting:notRequesting,deleteComment:deleteComment,createFollow:createFollow,deleteFollow:deleteFollow})(HomeContainer);","map":{"version":3,"sources":["/Users/owner/Desktop/finalprojects/MyStagram/MyFront-end/src/HomeContainer.js"],"names":["React","match","Postcard","NewPostCard","Follows","getFollows","createFollow","deleteFollow","connect","getPost","editCaption","fetchUser","fetchAllUsers","addComment","deleteComment","changeLike","logout","notRequesting","ProfileCard","Loader","Bio","HomeContainer","state","showCommentField","comment","post_id","Picture","caption","likes","page","likedPosts","postRecieveingComment","requesting","showingUserId","showingOne","showOneBio","postToDelete","show_x","submitComment","postId","props","userid","user","requestedPost","userId","body","content","followee_id","resetCommentLength","postToCommentOn","id","setState","handleComment","e","console","log","target","name","value","com","getCapField","editingCaption","handleEditSubmit","handleLikes","includes","deleteLike","likesArr","filter","pId","addLike","newLikes","like","numLikes","thePost","posts","users","history","length","map","post","theUsers","startShowingOneUser","handleNewPostClick","newPost","theNewPostCard","returnToThePost","myProfile","push","handleNewPost","pageToRender","showOneUser","showing","theUser","find","userPost","user_id","showOneUsersPost","p","pic","setIdForPostToBeDeleted","showOneUserBio","username","picture","bio","city","appLogout","localStorage","clear","returnToLogoutPage","requestedLogin","commentor","forEach","followeeIds","foll","follows","f","followees","Set","theFollow","ErId","EeId","follower_id","whoImFollowing","peepsImFollowing","u","whoImNotFollowing","friends","friendsArr","theFriends","Suggestedfriends","allButMe","nonfriendsArr","usersSinFollowers","nonFollowers","tempArr","showDelete_x","token","fposts","Component","mapStateToProps","all","requested","login","usersObj"],"mappings":"iuCAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,KAAT,KAAsB,OAAtB,CACA,MAAO,yBAAP,CACA,MAAOC,CAAAA,QAAP,KAAqB,uBAArB,CACA,MAAOC,CAAAA,WAAP,KAAwB,0BAAxB,CACA,MAAOC,CAAAA,OAAP,KAAoB,sBAApB,CACA,OAASC,UAAT,CAAqBC,YAArB,CAAmCC,YAAnC,KAAuD,+BAAvD,CACA,OAASC,OAAT,KAAwB,aAAxB,CACA,OAASC,OAAT,CAAkBC,WAAlB,KAAqC,6BAArC,CACA,OAASC,SAAT,CAAoBC,aAApB,KAAyC,6BAAzC,CACA,OAASC,UAAT,CAAqBC,aAArB,KAA0C,iCAA1C,CACA,OAASC,UAAT,KAA2B,6BAA3B,CACA,OAASC,MAAT,CAAiBC,aAAjB,KAAsC,8BAAtC,CACA,MAAOC,CAAAA,WAAP,KAAwB,8BAAxB,CACA,MAAOC,CAAAA,MAAP,KAAmB,qBAAnB,CACA,MAAOC,CAAAA,GAAP,KAAgB,sBAAhB,C,GAIMC,CAAAA,a,uaACJC,K,CAAQ,CACNC,gBAAgB,CAAE,KADZ,CAENC,OAAO,CAAE,EAFH,CAGNC,OAAO,CAAE,EAHH,CAINC,OAAO,CAAE,EAJH,CAKNC,OAAO,CAAE,EALH,CAMNC,KAAK,CAAE,CAND,CAONC,IAAI,CAAE,SAPA,CAQNC,UAAU,CAAE,EARN,CASNC,qBAAqB,CAAE,IATjB,CAUNC,UAAU,CAAE,KAVN,CAWNC,aAAa,CAAE,IAXT,CAYNC,UAAU,CAAE,KAZN,CAaNC,UAAU,CAAE,KAbN,CAcNC,YAAY,CAAE,CAdR,CAeNC,MAAM,CAAE,KAfF,C,OAmCRC,a,CAAgB,SAACC,MAAD,CAAY,iBAC0B,MAAKC,KAD/B,CAClBC,MADkB,aAClBA,MADkB,CACV5B,UADU,aACVA,UADU,CACE6B,IADF,aACEA,IADF,CACQC,aADR,aACQA,aADR,IAElBC,CAAAA,MAFkB,CAEP,MAAKtB,KAFE,CAElBsB,MAFkB,CAG1B,GAAMC,CAAAA,IAAI,CAAG,CACXpB,OAAO,CAAEc,MADE,CAEXO,OAAO,CAAE,MAAKxB,KAAL,CAAWE,OAFT,CAGXuB,WAAW,CAAEN,MAHF,CAAb,CAKA5B,UAAU,CAACgC,IAAD,CAAV,CACA,MAAKG,kBAAL,GAGD,C,OAGDC,e,CAAkB,SAACC,EAAD,CAAQ,CACxB,MAAKC,QAAL,CAAc,CAAEpB,qBAAqB,CAAEmB,EAAzB,CAAd,EACD,C,OAEDF,kB,CAAqB,UAAM,CACzB,MAAKG,QAAL,CAAc,CAAE3B,OAAO,CAAE,EAAX,CAAeO,qBAAqB,CAAE,IAAtC,CAAd,EACD,C,OAEDqB,a,CAAgB,SAACC,CAAD,CAAO,CACrBC,OAAO,CAACC,GAAR,CAAY,MAAKjC,KAAL,CAAWE,OAAvB,CAAgC,MAAKF,KAAL,CAAWiB,MAA3C,EACA,MAAKY,QAAL,oBACGE,CAAC,CAACG,MAAF,CAASC,IADZ,CACmBJ,CAAC,CAACG,MAAF,CAASE,KAD5B,GAGD,C,OAGD5C,a,CAAgB,SAAC6C,GAAD,CAAS,IACf7C,CAAAA,aADe,CACG,MAAK0B,KADR,CACf1B,aADe,CAGvB;AACAA,aAAa,CAAC6C,GAAG,CAACT,EAAL,CAASS,GAAG,CAAClC,OAAb,CAAsBkC,GAAG,CAACZ,WAA1B,CAAuCY,GAAG,CAACb,OAA3C,CAAb,CAED,C,OAIDc,W,CAAc,UAAM,CAClB,MAAKT,QAAL,CAAc,CAAEU,cAAc,CAAE,CAAC,MAAKvC,KAAL,CAAWuC,cAA9B,CAAd,EACD,C,OACDC,gB,CAAmB,SAACZ,EAAD,CAAQ,CACzB,MAAKV,KAAL,CAAW9B,WAAX,CAAuBwC,EAAvB,CAA2B,MAAK5B,KAAL,CAAWE,OAAtC,EACA,MAAK2B,QAAL,CAAc,CAAE3B,OAAO,CAAE,EAAX,CAAd,EACA,MAAKoC,WAAL,GACD,C,OACDrC,gB,CAAmB,UAAM,CACvB,MAAO,OAAK4B,QAAL,CAAc,CAAE5B,gBAAgB,CAAE,CAAC,MAAKD,KAAL,CAAWC,gBAAhC,CAAd,CAAP,CACD,C,OAKDwC,W,CAAc,SAACb,EAAD,CAAKtB,KAAL,CAAe,IACnBE,CAAAA,UADmB,CACJ,MAAKR,KADD,CACnBQ,UADmB,CAE3B,GAAIA,UAAU,CAACkC,QAAX,CAAoBd,EAApB,CAAJ,CAA6B,CAC3B,MAAKe,UAAL,CAAgBf,EAAhB,CAAoBtB,KAApB,EACA,GAAMsC,CAAAA,QAAQ,CAAGpC,UAAU,CAACqC,MAAX,CAAkB,SAAAC,GAAG,QAAIA,CAAAA,GAAG,GAAKlB,EAAZ,EAArB,CAAjB,CACA,MAAKC,QAAL,CAAc,CAAErB,UAAU,CAAEoC,QAAd,CAAd,EAED,CALD,IAMK,CACH,MAAKG,OAAL,CAAanB,EAAb,CAAiBtB,KAAjB,EACA,GAAM0C,CAAAA,QAAQ,8BAAOxC,UAAP,GAAmBoB,EAAnB,EAAd,CACA,MAAKC,QAAL,CAAc,CAAErB,UAAU,CAAEwC,QAAd,CAAd,EACD,CAEF,C,OAEDD,O,CAAU,SAACnB,EAAD,CAAKqB,IAAL,CAAc,CAEtB;AACA,GAAMC,CAAAA,QAAQ,CAAGD,IAAI,CAAG,CAAxB,CACA,MAAK/B,KAAL,CAAWzB,UAAX,CAAsBmC,EAAtB,CAA0BsB,QAA1B,CAAoC,KAApC,EACD,C,OACDP,U,CAAa,SAACf,EAAD,CAAKqB,IAAL,CAAc,CACzB;AACA,GAAMC,CAAAA,QAAQ,CAAGD,IAAI,CAAG,CAAxB,CACA,MAAK/B,KAAL,CAAWzB,UAAX,CAAsBmC,EAAtB,CAA0BsB,QAA1B,CAAoC,EAApC,EACD,C,OAMDC,O,CAAU,UAAM,kBACoB,MAAKjC,KADzB,CACNkC,KADM,cACNA,KADM,CACCC,KADD,cACCA,KADD,CACQC,OADR,cACQA,OADR,iBAE4F,MAAKtD,KAFjG,CAENE,OAFM,aAENA,OAFM,CAEGD,gBAFH,aAEGA,gBAFH,CAEqBsC,cAFrB,aAEqBA,cAFrB,CAEqC/B,UAFrC,aAEqCA,UAFrC,CAEiDmB,eAFjD,aAEiDA,eAFjD,CAEkElB,qBAFlE,aAEkEA,qBAFlE,CAGd,MAAO2C,CAAAA,KAAK,EAAIA,KAAK,CAACG,MAAN,CAAe,CAAxB,CAA4BH,KAAK,CAACI,GAAN,CAAU,SAAAC,IAAI,QAE/C,qBAAC,QAAD,EACE,KAAK,CAAEJ,KADT,CAEE,IAAI,CAAEI,IAFR,CAGE,OAAO,CAAEH,OAHX,CAIE,UAAU,CAAEpD,OAAO,CAACqD,MAJtB,CAKE,kBAAkB,CAAE,MAAKtD,gBAL3B,CAME,kBAAkB,CAAEA,gBANtB,CAOE,SAAS,CAAEQ,qBAPb,CAQE,YAAY,CAAE,MAAKkB,eARrB,CASE,EAAE,CAAE8B,IAAI,CAAC7B,EATX,CAUE,YAAY,CAAE,MAAKF,kBAVrB,CAWE,aAAa,CAAE,+BAAM,OAAKV,aAAL,CAAmByC,IAAI,CAAC7B,EAAxB,CAA4B6B,IAAI,CAACnC,MAAjC,CAAN,EAXjB,CAYE,aAAa,CAAE,MAAKQ,aAZtB,CAaE,WAAW,CAAE,MAAKW,WAbpB,CAcE,eAAe,CAAE,MAAKH,WAdxB,CAeE,aAAa,CAAEC,cAfjB,CAgBE,aAAa,CAAE,MAAKC,gBAhBtB,CAiBE,OAAO,CAAE,MAAKO,OAjBhB,CAkBE,OAAO,CAAE,MAAKJ,UAlBhB,CAmBE,KAAK,CAAEnC,UAnBT,CAoBE,UAAU,CAAE,MAAKkD,QApBnB,CAqBE,aAAa,CAAE,MAAKlE,aArBtB,CAsBE,YAAY,CAAE,MAAKmE,mBAtBrB,EAF+C,EAAd,CAA5B,CA0BF3B,OAAO,CAACC,GAAR,CAAY,0CAAZ,CAAwD,MAAKf,KAA7D,CA1BL,CA2BD,C,OAMD0C,kB,CAAqB,UAAM,CACzB,MAAK/B,QAAL,CAAc,CAAEgC,OAAO,CAAE,CAAC,MAAK7D,KAAL,CAAW6D,OAAvB,CAAd,EACD,C,OAEDC,c,CAAiB,SAAA5C,KAAK,CAAI,IAChBC,CAAAA,MADgB,CACL,MAAKD,KADA,CAChBC,MADgB,CAExB,MACE,qBAAC,WAAD,EACE,IAAI,CAAE,MAAK4C,eADb,EADF,CAKD,C,OAEDC,S,CAAY,UAAM,CAChB,MAAK9C,KAAL,CAAWoC,OAAX,CAAmBW,IAAnB,CAAwB,UAAxB,EACD,C,OAGDF,e,CAAkB,UAAM,CACtB,MAAKlC,QAAL,CAAc,CAAEtB,IAAI,CAAE,SAAR,CAAmBK,UAAU,CAAE,KAA/B,CAAd,EACD,C,OAGDsD,a,CAAgB,SAAAnC,CAAC,CAAI,CACnB,MAAKF,QAAL,oBACGE,CAAC,CAACG,MAAF,CAASC,IADZ,CACmBJ,CAAC,CAACG,MAAF,CAASE,KAD5B,GAGD,C,OAED+B,Y,CAAe,UAAM,IACXxD,CAAAA,aADW,CACO,MAAKX,KADZ,CACXW,aADW,CAEnB,OAAQ,MAAKX,KAAL,CAAWO,IAAnB,EACE,IAAK,SAAL,CACE,MAAO,OAAK4C,OAAL,EAAP,CACF,IAAK,SAAL,CACE,MAAO,OAAKW,cAAL,EAAP,CACF,IAAK,SAAL,CACE,MAAO,OAAKE,SAAL,EAAP,CACF,IAAK,UAAL,CACE,MAAO,OAAKI,WAAL,CAAiBzD,aAAjB,CAAP,CARJ,CAUD,C,OAEDgD,mB,CAAsB,SAAC/B,EAAD,CAAQ,CAC5B,MAAKC,QAAL,CAAc,CAAElB,aAAa,CAAEiB,EAAjB,CAAqBrB,IAAI,CAAE,UAA3B,CAAuCK,UAAU,CAAE,CAAC,MAAKZ,KAAL,CAAWqE,OAA/D,CAAd,EACD,C,OACDD,W,CAAc,SAACxC,EAAD,CAAQ,kBACW,MAAKV,KADhB,CACZmC,KADY,cACZA,KADY,CACLD,KADK,cACLA,KADK,CACEjB,IADF,cACEA,IADF,CAEpB,GAAMmC,CAAAA,OAAO,CAAGjB,KAAK,CAACkB,IAAN,CAAW,SAAAnD,IAAI,QAAIA,CAAAA,IAAI,CAACQ,EAAL,GAAYA,EAAhB,EAAf,CAAhB,CACAI,OAAO,CAACC,GAAR,CAAY,qBAAZ,CAAmCqC,OAAnC,EACA,GAAME,CAAAA,QAAQ,CAAGpB,KAAK,CAACP,MAAN,CAAa,SAAAY,IAAI,QAAIA,CAAAA,IAAI,CAACgB,OAAL,GAAiBH,OAAO,CAAC1C,EAA7B,EAAjB,CAAjB,CAEA,MAAO,OAAK8C,gBAAL,CAAsBF,QAAtB,CAAP,CAGD,C,OACDE,gB,CAAmB,SAACjB,IAAD,CAAU,kBACc,MAAKzD,KADnB,CACnBQ,UADmB,cACnBA,UADmB,CACPN,OADO,cACPA,OADO,CACEC,OADF,cACEA,OADF,kBAEK,MAAKe,KAFV,CAEnBiB,IAFmB,cAEnBA,IAFmB,CAEbkB,KAFa,cAEbA,KAFa,CAENlC,MAFM,cAENA,MAFM,CAK3B,MAAOsC,CAAAA,IAAI,CAACD,GAAL,CAAS,SAAAmB,CAAC,QAAI,qBAAC,WAAD,EACnB,IAAI,CAAEA,CADa,CAEnB,OAAO,CAAEA,CAAC,CAACF,OAFQ,CAGnB,KAAK,CAAEpB,KAHY,CAInB,IAAI,CAAElB,IAJa,CAKnB,GAAG,CAAEwC,CAAC,CAACC,GALY,CAMnB,EAAE,CAAED,CAAC,CAAC/C,EANa,CAOnB,UAAU,CAAEpB,UAPO,CAQnB,OAAO,CAAEN,OARU,CASnB,UAAU,CAAE,MAAKuC,WATE,CAUnB,KAAK,CAAE,MAAKoC,uBAVO,CAWnB,aAAa,CAAE,MAAK/C,aAXD,CAYnB,UAAU,CAAE3B,OAZO,CAanB,aAAa,CAAEgB,MAbI,CAcnB,aAAa,CAAE,MAAKH,aAdD,CAenB,YAAY,CAAE,MAAKU,kBAfA,CAgBnB,YAAY,CAAE,MAAK1B,KAAL,CAAWE,OAhBN,EAAJ,EAAV,CAAP,CAmBD,C,OACD4E,c,CAAiB,UAAM,IACbzB,CAAAA,KADa,CACH,MAAKnC,KADF,CACbmC,KADa,IAEb1C,CAAAA,aAFa,CAEK,MAAKX,KAFV,CAEbW,aAFa,CAGrB,GAAM2D,CAAAA,OAAO,CAAGjB,KAAK,CAACkB,IAAN,CAAW,SAAAnD,IAAI,QAAIA,CAAAA,IAAI,CAACQ,EAAL,GAAYjB,aAAhB,EAAf,CAAhB,CAEA,MAAO,qBAAC,GAAD,EACL,IAAI,CAAE2D,OAAO,CAACS,QADT,CAEL,GAAG,CAAET,OAAO,CAACU,OAFR,CAGL,GAAG,CAAEV,OAAO,CAACW,GAHR,CAIL,IAAI,CAAEX,OAAO,CAACY,IAJT,CAKL,KAAK,CAAEZ,OAAO,CAACtE,KALV,CAML,IAAI,CAAE,MAAK+D,eANN,EAAP,CAYD,C,OAIDoB,S,CAAY,UAAM,IACRzF,CAAAA,MADQ,CACG,MAAKwB,KADR,CACRxB,MADQ,CAEhBA,MAAM,GACN0F,YAAY,CAACC,KAAb,GACAD,YAAY,CAAC7B,MAAb,GAAwB,CAAxB,EAA6B,MAAK+B,kBAAL,EAA7B,CAED,C,OAEDA,kB,CAAqB,UAAM,kBACU,MAAKpE,KADf,CACjBqE,cADiB,cACjBA,cADiB,CACD7F,MADC,cACDA,MADC,CAEzBA,MAAM,GACN,MAAKwB,KAAL,CAAWoC,OAAX,CAAmBW,IAAnB,CAAwB,GAAxB,EACD,C,OACDP,Q,CAAW,UAAM,IACPL,CAAAA,KADO,CACG,MAAKnC,KADR,CACPmC,KADO,CAEf,GAAMmC,CAAAA,SAAS,CAAG,EAAlB,CACA,GAAI,CAAC,CAACnC,KAAN,CAAa,CACX,MAAKnC,KAAL,CAAWmC,KAAX,CAAiBoC,OAAjB,CAAyB,SAAArE,IAAI,QAAIoE,CAAAA,SAAS,CAACpE,IAAI,CAACQ,EAAN,CAAT,CAAqBR,IAAI,CAAC2D,QAA9B,EAA7B,EACA,MAAOS,CAAAA,SAAP,CACD,CACF,C,OAGDE,W,CAAc,UAAM,CAClB;AACA,GAAMC,CAAAA,IAAI,CAAG,MAAKzE,KAAL,CAAW0E,OAAX,CAAmBpC,GAAnB,CAAuB,SAAAqC,CAAC,QAAIA,CAAAA,CAAC,CAACpE,WAAN,EAAxB,CAAb,CACA,GAAMqE,CAAAA,SAAS,oBAAO,GAAIC,CAAAA,GAAJ,CAAQJ,IAAR,CAAP,CAAf,CAAqC;AACrC,MAAOG,CAAAA,SAAP,CACD,C,OACDE,S,CAAY,SAACC,IAAD,CAAOC,IAAP,CAAgB,CAE1B,MAAO,OAAKhF,KAAL,CAAW0E,OAAX,CAAmBrB,IAAnB,CAAwB,SAAAsB,CAAC,QAAIA,CAAAA,CAAC,CAACM,WAAF,GAAkBF,IAAlB,EAA0BJ,CAAC,CAACpE,WAAF,GAAkByE,IAAhD,EAAzB,EAA+EtE,EAAtF,CACD,C,OACDwE,c,CAAiB,UAAM,kBACc,MAAKlF,KADnB,CACb0E,OADa,cACbA,OADa,CACJzE,MADI,cACJA,MADI,CACIkC,KADJ,cACIA,KADJ,CAErB,GAAMgD,CAAAA,gBAAgB,CAAGhD,KAAK,CAACR,MAAN,CAAa,SAAAyD,CAAC,QAAIV,CAAAA,OAAO,CAAC/C,MAAR,CAAe,SAAAgD,CAAC,QACzDA,CAAAA,CAAC,CAACM,WAAF,GAAkBhF,MAAlB,EAA4B0E,CAAC,CAACpE,WAAF,GAAkB6E,CAAC,CAAC1E,EADS,EAAhB,CAAJ,EAAd,CAAzB,CAEA,MAAOyE,CAAAA,gBAAP,CACD,C,OACDE,iB,CAAoB,UAAM,kBACW,MAAKrF,KADhB,CAChB0E,OADgB,cAChBA,OADgB,CACPzE,MADO,cACPA,MADO,CACCkC,KADD,cACCA,KADD,CAExB,GAAMgD,CAAAA,gBAAgB,CAAGhD,KAAK,CAACR,MAAN,CAAa,SAAAyD,CAAC,QAAIV,CAAAA,OAAO,CAACpC,GAAR,CAAY,SAAAqC,CAAC,QACtDA,CAAAA,CAAC,CAACM,WAAF,GAAkBhF,MAAlB,EAA4B0E,CAAC,CAACpE,WAAF,GAAkB6E,CAAC,CAAC1E,EADM,EAAb,CAAJ,EAAd,CAAzB,CAEA,MAAOyE,CAAAA,gBAAP,CACD,C,OAEDG,O,CAAU,UAAM,kBACyC,MAAKtF,KAD9C,CACN0E,OADM,cACNA,OADM,CACGzE,MADH,cACGA,MADH,CACWkC,KADX,cACWA,KADX,CACkBpE,YADlB,cACkBA,YADlB,CACgCmC,IADhC,cACgCA,IADhC,CAEd,GAAMqF,CAAAA,UAAU,CAAGb,OAAO,CAAC/C,MAAR,CAAe,SAAAgD,CAAC,QAAIA,CAAAA,CAAC,CAACM,WAAF,GAAkBhF,MAAtB,EAAhB,EAA8CqC,GAA9C,CAAkD,SAAAqC,CAAC,QAAIA,CAAAA,CAAC,CAACpE,WAAN,EAAnD,CAAnB,CAEA,GAAMiF,CAAAA,UAAU,CAAGD,UAAU,CAACjD,GAAX,CAAe,SAAAqC,CAAC,QAAIxC,CAAAA,KAAK,CAACkB,IAAN,CAAW,SAAAnD,IAAI,QAAIA,CAAAA,IAAI,CAACQ,EAAL,GAAYiE,CAAhB,EAAf,CAAJ,EAAhB,CAAnB,CAEA,GAAIa,UAAU,CAACnD,MAAX,CAAoB,CAAxB,CAA2B,CACzB,MAAOmD,CAAAA,UAAU,CAAClD,GAAX,CAAe,SAAAqC,CAAC,QAAI,oCAAM,2BAAK,GAAG,CAAEA,CAAC,CAACb,OAAZ,CAAqB,SAAS,CAAC,sBAA/B,CAAsD,OAAO,CAAE,yBAAM,OAAKrB,mBAAL,CAAyBkC,CAAC,CAACjE,EAA3B,CAAN,EAA/D,EAAN,KACtB,8BADsB,CAChB,4BAAM,SAAS,CAAC,qBAAhB,CAAsC,EAAE,CAAEiE,CAAC,CAACjE,EAA5C,CAAgD,OAAO,CAAE,yBAAM3C,CAAAA,YAAY,CAAC,MAAK+G,SAAL,CAAe7E,MAAf,CAAuB0E,CAAC,CAACjE,EAAzB,CAAD,CAAlB,EAAzD,YAA+GiE,CAAC,CAACd,QAAjH,kBADgB,KAAJ,EAAhB,CAAP,CAED,CAHD,IAIK,CACH,MAAO,4BAAK,SAAS,CAAC,mBAAf,EAEL,wDAAc3D,IAAd,8CAFK,CAAP,CAKD,CAEF,C,OACDuF,gB,CAAmB,UAAM,kBAC0B,MAAKzF,KAD/B,CACflC,YADe,cACfA,YADe,CACDmC,MADC,cACDA,MADC,CACOkC,KADP,cACOA,KADP,CACcuC,OADd,cACcA,OADd,CAEvB,GAAMgB,CAAAA,QAAQ,CAAGvD,KAAK,CAACR,MAAN,CAAa,SAAAzB,IAAI,QAAIA,CAAAA,IAAI,CAACQ,EAAL,GAAYT,MAAhB,EAAjB,CAAjB,CACA,GAAM0F,CAAAA,aAAa,CAAGjB,OAAO,CAAC/C,MAAR,CAAe,SAAAgD,CAAC,QAAIA,CAAAA,CAAC,CAACM,WAAF,GAAkBhF,MAAtB,EAAhB,EAA8CqC,GAA9C,CAAkD,SAAAqC,CAAC,QAAIA,CAAAA,CAAC,CAACpE,WAAN,EAAnD,CAAtB,CACA,GAAMgF,CAAAA,UAAU,CAAGb,OAAO,CAAC/C,MAAR,CAAe,SAAAgD,CAAC,QAAIA,CAAAA,CAAC,CAACM,WAAF,GAAkBhF,MAAtB,EAAhB,EAA8CqC,GAA9C,CAAkD,SAAAqC,CAAC,QAAIA,CAAAA,CAAC,CAACpE,WAAN,EAAnD,CAAnB,CACA,GAAMqF,CAAAA,iBAAiB,CAAGF,QAAQ,CAAC/D,MAAT,CAAgB,SAAAyD,CAAC,QAAI,CAAC,MAAKZ,WAAL,GAAmBhD,QAAnB,CAA4B4D,CAAC,CAAC1E,EAA9B,CAAL,EAAjB,CAA1B,CACA,GAAMmF,CAAAA,YAAY,CAAGH,QAAQ,CAAC/D,MAAT,CAAgB,SAAAyD,CAAC,QAAIO,CAAAA,aAAa,CAACnE,QAAd,CAAuB4D,CAAC,CAAC1E,EAAzB,GAAgC,CAAC6E,UAAU,CAAC/D,QAAX,CAAoB4D,CAAC,CAAC1E,EAAtB,CAArC,EAAjB,CAArB,CACA,GAAMoF,CAAAA,OAAO,8BAAOD,YAAP,qBAAwBD,iBAAxB,EAAb,CACA,GAAMP,CAAAA,iBAAiB,oBAAO,GAAIR,CAAAA,GAAJ,CAAQiB,OAAR,CAAP,CAAvB,CAIA,MAAOT,CAAAA,iBAAiB,CAAC/C,GAAlB,CAAsB,SAAAqC,CAAC,QAAI,oCAAM,2BAAK,GAAG,CAAEA,CAAC,CAACb,OAAZ,CAAqB,SAAS,CAAC,sBAA/B,CAAsD,OAAO,CAAE,kBAAM,CAE3G,MAAKrB,mBAAL,CAAyBkC,CAAC,CAACjE,EAA3B,EACD,CAHuC,EAAN,KAG5B,8BAH4B,CAGtB,4BAAM,SAAS,CAAC,qBAAhB,CAAsC,OAAO,CAAE,yBAAM5C,CAAAA,YAAY,CAAC6G,CAAC,CAACjE,EAAH,CAAOT,MAAP,CAAlB,EAA/C,CAAiF,EAAE,CAAE0E,CAAC,CAACjE,EAAvF,aAAgGiE,CAAC,CAACd,QAAlG,YAHsB,CAAJ,EAAvB,CAAP,CAKD,C,OAIDF,uB,CAA0B,SAACjD,EAAD,CAAQ,CAChC,MAAKC,QAAL,CAAc,CAAEf,YAAY,CAAEc,EAAhB,CAAd,EACA,MAAKqF,YAAL,GACAjF,OAAO,CAACC,GAAR,CAAY,MAAKjC,KAAL,CAAWc,YAAvB,EAED,C,OACDmG,Y,CAAe,UAAM,CACnB,MAAKpF,QAAL,CAAc,CAAEd,MAAM,CAAE,CAAC,MAAKf,KAAL,CAAWe,MAAtB,CAAd,EACD,C,sGA7UmB,mBAC6B,KAAKG,KADlC,CACV/B,OADU,eACVA,OADU,CACDG,aADC,eACDA,aADC,CACcP,UADd,eACcA,UADd,CAElBI,OAAO,GAAIG,aAAa,GAAIP,UAAU,GACtCiD,OAAO,CAACC,GAAR,CAAY,gBAAZ,EAHkB,GAIVqB,CAAAA,OAJU,CAIE,KAAKpC,KAJP,CAIVoC,OAJU,CAMlB,CAAC8B,YAAY,CAAC8B,KAAd,EAAuB5D,OAAO,CAACW,IAAR,CAAa,GAAb,CAAvB,CAED,CAED;uCAqUS,mCAE4D,KAAK/C,KAFjE,CAECiG,MAFD,eAECA,MAFD,CAES/F,IAFT,eAESA,IAFT,CAEeE,MAFf,eAEeA,MAFf,CAEuBgC,OAFvB,eAEuBA,OAFvB,CAEgCiC,cAFhC,eAEgCA,cAFhC,CAEgDP,OAFhD,eAEgDA,OAFhD,kBAG+B,KAAKhF,KAHpC,CAGCY,UAHD,cAGCA,UAHD,CAGaD,aAHb,cAGaA,aAHb,CAIP,KAAK+C,QAAL,GACA,KAAKgC,WAAL,GACA,KAAKU,cAAL,GAEA,MACE,4BAAK,SAAS,CAAC,gBAAf,EACE,oBAAC,OAAD,MADF,CAEE,2BAAK,SAAS,CAAC,cAAf,EACE,8BACE,0BAAI,EAAE,CAAC,WAAP,CAAmB,OAAO,CAAE,yBAAM,CAAA,MAAI,CAACrC,eAAL,EAAN,EAA5B,EAA0D,gCAAQ,KAAK7C,KAAL,CAAWE,IAAnB,aAA1D,CACE,yBAAG,OAAO,CAAE,KAAK+D,SAAjB,CAA4B,SAAS,CAAC,QAAtC,cADF,CADF,CAIE,8BACE,yBAAG,SAAS,CAAC,QAAb,CAAsB,EAAE,CAAE,KAAKnF,KAAL,CAAW4B,EAArC,CAAyC,OAAO,CAAE,yBAAM,CAAA,MAAI,CAACC,QAAL,CAAc,CAAEtB,IAAI,CAAE,SAAR,CAAd,CAAN,EAAlD,mBADF,CAJF,CASE,0BAAI,SAAS,CAAC,WAAd,CAA0B,OAAO,CAAE,yBAAM,CAAA,MAAI,CAACsB,QAAL,CAAc,CAAEtB,IAAI,CAAE,SAAR,CAAd,CAAN,EAAnC,EAA6E,2BAAK,GAAG,CAAEyE,OAAV,CAAmB,EAAE,CAAC,WAAtB,EAA7E,KATF,CADF,CAFF,CAiBE,2BAAK,SAAS,CAAE,CAACI,YAAY,CAAC8B,KAAd,CAAsB,UAAtB,CAAmC,cAAnD,EAEE,2BAAK,SAAS,CAAC,kBAAf,EACG,CAACtG,UAAD,CAAc,4BAAM,SAAS,CAAC,+BAAhB,eAAd,CAAkF,IADrF,CAEG,CAACA,UAAD,CAAc,KAAK+F,gBAAL,EAAd,CAAwC,KAAK7B,cAAL,EAF3C,CAFF,CAOG,CAAClE,UAAD,CAAc,2BAAK,SAAS,CAAC,SAAf,EACb,4BAAM,SAAS,CAAC,+BAAhB,YADa,CAEZ,KAAK4F,OAAL,EAFY,CAAd,CAGQ,IAVX,CAYG,KAAKrC,YAAL,EAZH,CAaG,KAAKnE,KAAL,CAAWO,IAAX,GAAoB,SAApB,CAAgC,2BAAK,SAAS,CAAC,aAAf,mCAAhC,CAAsG,wCAbzG,CAjBF,CADF,CAuCD,C,2BArZyB7B,KAAK,CAAC0I,S,EAwZlC,GAAMC,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,CAACrH,KAAD,CAAW,CACjC,MAAO,CACLoB,IAAI,CAAEpB,KAAK,CAACqD,KAAN,CAAY0B,QADb,CAEL5D,MAAM,CAAEnB,KAAK,CAACqD,KAAN,CAAYzB,EAFf,CAGLoD,OAAO,CAAEhF,KAAK,CAACqD,KAAN,CAAY2B,OAHhB,CAIL3B,KAAK,CAAErD,KAAK,CAACqD,KAAN,CAAYiE,GAJd,CAKLlE,KAAK,CAAEpD,KAAK,CAACyD,IAAN,CAAWL,KALb,CAML/B,aAAa,CAAErB,KAAK,CAACyD,IAAN,CAAW8D,SANrB,CAOLhC,cAAc,CAAEvF,KAAK,CAACwH,KAAN,CAAYD,SAPvB,CAQL3B,OAAO,CAAE5F,KAAK,CAAC4F,OAAN,CAAcA,OARlB,CASLzD,IAAI,CAAEnC,KAAK,CAACqD,KAAN,CAAYoE,QATb,CAAP,CAWD,CAZD,CAcA,cAAevI,CAAAA,OAAO,CAACmI,eAAD,CAAkB,CAAEtI,UAAU,CAAVA,UAAF,CAAcI,OAAO,CAAPA,OAAd,CAAuBG,aAAa,CAAbA,aAAvB,CAAsCD,SAAS,CAATA,SAAtC,CAAiDE,UAAU,CAAVA,UAAjD,CAA6DH,WAAW,CAAXA,WAA7D,CAA0EK,UAAU,CAAVA,UAA1E,CAAsFC,MAAM,CAANA,MAAtF,CAA8FC,aAAa,CAAbA,aAA9F,CAA6GH,aAAa,CAAbA,aAA7G,CAA4HR,YAAY,CAAZA,YAA5H,CAA0IC,YAAY,CAAZA,YAA1I,CAAlB,CAAP,CAAmLc,aAAnL,CAAf","sourcesContent":["import React from \"react\";\nimport { match } from 'react'\nimport \"./css/HomeContainer.css\";\nimport Postcard from \"./components/PostCard\";\nimport NewPostCard from \"./components/NewPostCard\";\nimport Follows from './components/Follows';\nimport { getFollows, createFollow, deleteFollow } from './redux/actions/FollowActions';\nimport { connect } from 'react-redux';\nimport { getPost, editCaption } from './redux/actions/PostActions';\nimport { fetchUser, fetchAllUsers } from './redux/actions/UserActions';\nimport { addComment, deleteComment } from './redux/actions/CommentsActions';\nimport { changeLike } from './redux/actions/PostActions';\nimport { logout, notRequesting } from './redux/actions/LoginActions';\nimport ProfileCard from './components/ProfilePostCard'\nimport Loader from './components/loader';\nimport Bio from './components/UserBio'\n\n\n\nclass HomeContainer extends React.Component {\n  state = {\n    showCommentField: false,\n    comment: \"\",\n    post_id: \"\",\n    Picture: \"\",\n    caption: \"\",\n    likes: 0,\n    page: \"thePost\",\n    likedPosts: [],\n    postRecieveingComment: null,\n    requesting: false,\n    showingUserId: null,\n    showingOne: false,\n    showOneBio: false,\n    postToDelete: 0,\n    show_x: false\n\n  }\n\n\n    ;\n\n  componentDidMount() {\n    const { getPost, fetchAllUsers, getFollows } = this.props\n    getPost(); fetchAllUsers(); getFollows()\n    console.log(\"HOME CONTAINER\")\n    const { history } = this.props\n\n    !localStorage.token && history.push('/')\n\n  }\n\n  // COMMENTS //\n\n\n  submitComment = (postId) => {\n    const { userid, addComment, user, requestedPost } = this.props\n    const { userId } = this.state\n    const body = {\n      post_id: postId,\n      content: this.state.comment,\n      followee_id: userid\n    }\n    addComment(body)\n    this.resetCommentLength()\n\n\n  };\n\n\n  postToCommentOn = (id) => {\n    this.setState({ postRecieveingComment: id })\n  }\n\n  resetCommentLength = () => {\n    this.setState({ comment: \"\", postRecieveingComment: null })\n  }\n\n  handleComment = (e) => {\n    console.log(this.state.comment, this.state.postId);\n    this.setState({\n      [e.target.name]: e.target.value\n    });\n  };\n\n\n  deleteComment = (com) => {\n    const { deleteComment } = this.props\n\n    // console.log(com.id, com.post_id, com.followee_id, com.content)\n    deleteComment(com.id, com.post_id, com.followee_id, com.content)\n\n  }\n\n  // EDIT CAPTION\n\n  getCapField = () => {\n    this.setState({ editingCaption: !this.state.editingCaption })\n  }\n  handleEditSubmit = (id) => {\n    this.props.editCaption(id, this.state.comment)\n    this.setState({ comment: \"\" })\n    this.getCapField()\n  }\n  showCommentField = () => {\n    return this.setState({ showCommentField: !this.state.showCommentField })\n  }\n\n\n  // LIKES //\n\n  handleLikes = (id, likes) => {\n    const { likedPosts } = this.state\n    if (likedPosts.includes(id)) {\n      this.deleteLike(id, likes)\n      const likesArr = likedPosts.filter(pId => pId !== id)\n      this.setState({ likedPosts: likesArr })\n\n    }\n    else {\n      this.addLike(id, likes)\n      const newLikes = [...likedPosts, id]\n      this.setState({ likedPosts: newLikes })\n    }\n\n  }\n\n  addLike = (id, like) => {\n\n    // this.setState({ liked: !this.state.liked })\n    const numLikes = like + 1\n    this.props.changeLike(id, numLikes, \"add\")\n  }\n  deleteLike = (id, like) => {\n    // this.setState({ liked: !this.state.liked })\n    const numLikes = like - 1\n    this.props.changeLike(id, numLikes, \"\")\n  }\n\n\n  // POST STUFF  //\n\n\n  thePost = () => {\n    const { posts, users, history } = this.props\n    const { comment, showCommentField, editingCaption, likedPosts, postToCommentOn, postRecieveingComment } = this.state\n    return posts && posts.length > 0 ? posts.map(post => (\n\n      <Postcard\n        users={users}\n        post={post}\n        history={history}\n        commentLen={comment.length}\n        toggleCommentField={this.showCommentField}\n        commentFieldStatus={showCommentField}\n        yourField={postRecieveingComment}\n        post2comment={this.postToCommentOn}\n        id={post.id}\n        resetComment={this.resetCommentLength}\n        submitComment={() => this.submitComment(post.id, post.userId)}\n        handleComment={this.handleComment}\n        handleLikes={this.handleLikes}\n        getCapEditField={this.getCapField}\n        editCapStatus={editingCaption}\n        submitCapEdit={this.handleEditSubmit}\n        addLike={this.addLike}\n        disLike={this.deleteLike}\n        liked={likedPosts}\n        commentors={this.theUsers}\n        deleteComment={this.deleteComment}\n        showThisUser={this.startShowingOneUser}\n      />\n    )) : console.log(\"The Post didnt work, here are the props:\", this.props)\n  };\n\n\n\n  // NEW POST STUFF \n  // SUBMIT THE COMMENT /FETCH POST\n  handleNewPostClick = () => {\n    this.setState({ newPost: !this.state.newPost });\n  };\n\n  theNewPostCard = props => {\n    const { userid } = this.props\n    return (\n      <NewPostCard\n        back={this.returnToThePost}\n      />\n    );\n  };\n\n  myProfile = () => {\n    this.props.history.push('/profile')\n  };\n\n\n  returnToThePost = () => {\n    this.setState({ page: \"thePost\", showingOne: false })\n  }\n\n\n  handleNewPost = e => {\n    this.setState({\n      [e.target.name]: e.target.value\n    });\n  };\n\n  pageToRender = () => {\n    const { showingUserId } = this.state\n    switch (this.state.page) {\n      case \"thePost\":\n        return this.thePost()\n      case \"newPost\":\n        return this.theNewPostCard()\n      case \"profile\":\n        return this.myProfile()\n      case \"show one\":\n        return this.showOneUser(showingUserId)\n    }\n  }\n\n  startShowingOneUser = (id) => {\n    this.setState({ showingUserId: id, page: \"show one\", showingOne: !this.state.showing })\n  }\n  showOneUser = (id) => {\n    const { users, posts, name } = this.props\n    const theUser = users.find(user => user.id === id)\n    console.log(\"The one user stuff:\", theUser)\n    const userPost = posts.filter(post => post.user_id === theUser.id)\n\n    return this.showOneUsersPost(userPost)\n\n\n  }\n  showOneUsersPost = (post) => {\n    const { likedPosts, comment, post_id } = this.state\n    const { name, users, userid } = this.props\n\n\n    return post.map(p => <ProfileCard\n      post={p}\n      user_id={p.user_id}\n      users={users}\n      name={name}\n      pic={p.pic}\n      id={p.id}\n      likedPosts={likedPosts}\n      comment={comment}\n      handleLike={this.handleLikes}\n      setId={this.setIdForPostToBeDeleted}\n      handleComment={this.handleComment}\n      postCommId={post_id}\n      currentUserId={userid}\n      submitComment={this.submitComment}\n      resetComment={this.resetCommentLength}\n      commentState={this.state.comment}\n    />\n    )\n  }\n  showOneUserBio = () => {\n    const { users } = this.props\n    const { showingUserId } = this.state\n    const theUser = users.find(user => user.id === showingUserId)\n\n    return <Bio\n      user={theUser.username}\n      pic={theUser.picture}\n      bio={theUser.bio}\n      city={theUser.city}\n      state={theUser.state}\n      home={this.returnToThePost}\n\n\n\n    />\n\n  }\n\n  // LOGOUT //\n\n  appLogout = () => {\n    const { logout } = this.props\n    logout()\n    localStorage.clear()\n    localStorage.length === 0 && this.returnToLogoutPage()\n\n  }\n\n  returnToLogoutPage = () => {\n    const { requestedLogin, logout } = this.props\n    logout()\n    this.props.history.push('/')\n  }\n  theUsers = () => {\n    const { users } = this.props\n    const commentor = {}\n    if (!!users) {\n      this.props.users.forEach(user => commentor[user.id] = user.username)\n      return commentor\n    }\n  }\n\n  // FREINDS\n  followeeIds = () => {\n    // EVERYONE WHO IS FOLLOWED\n    const foll = this.props.follows.map(f => f.followee_id)\n    const followees = [...new Set(foll)] // deletes/ filters duplicates out of arrays\n    return followees\n  }\n  theFollow = (ErId, EeId) => {\n\n    return this.props.follows.find(f => f.follower_id === ErId && f.followee_id === EeId).id\n  }\n  whoImFollowing = () => {\n    const { follows, userid, users } = this.props\n    const peepsImFollowing = users.filter(u => follows.filter(f =>\n      f.follower_id === userid && f.followee_id === u.id))\n    return peepsImFollowing\n  }\n  whoImNotFollowing = () => {\n    const { follows, userid, users } = this.props\n    const peepsImFollowing = users.filter(u => follows.map(f =>\n      f.follower_id !== userid && f.followee_id === u.id))\n    return peepsImFollowing\n  }\n\n  friends = () => {\n    const { follows, userid, users, deleteFollow, user } = this.props\n    const friendsArr = follows.filter(f => f.follower_id === userid).map(f => f.followee_id)\n\n    const theFriends = friendsArr.map(f => users.find(user => user.id === f))\n\n    if (theFriends.length > 0) {\n      return theFriends.map(f => <div> <img src={f.picture} className=\"friends-or-not-image\" onClick={() => this.startShowingOneUser(f.id)\n      } /> <br /><span className=\"friends-or-not-name\" id={f.id} onClick={() => deleteFollow(this.theFollow(userid, f.id))}>{`${f.username} 𝚡`}</span> </div>)\n    }\n    else {\n      return <div className=\"make-some-friends\">\n\n        <p>{`⬅️ Hey ${user}, Make Some ⬅️ New Friends!`} </p>\n\n      </div>\n    }\n\n  }\n  Suggestedfriends = () => {\n    const { createFollow, userid, users, follows } = this.props\n    const allButMe = users.filter(user => user.id !== userid)\n    const nonfriendsArr = follows.filter(f => f.follower_id !== userid).map(f => f.followee_id)\n    const friendsArr = follows.filter(f => f.follower_id === userid).map(f => f.followee_id)\n    const usersSinFollowers = allButMe.filter(u => !this.followeeIds().includes(u.id))\n    const nonFollowers = allButMe.filter(u => nonfriendsArr.includes(u.id) && !friendsArr.includes(u.id))\n    const tempArr = [...nonFollowers, ...usersSinFollowers]\n    const whoImNotFollowing = [...new Set(tempArr)]\n\n\n\n    return whoImNotFollowing.map(f => <div> <img src={f.picture} className=\"friends-or-not-image\" onClick={() => {\n\n      this.startShowingOneUser(f.id)\n    }} /> <br /><span className=\"friends-or-not-name\" onClick={() => createFollow(f.id, userid)} id={f.id}>{` ${f.username} ✓`}</span></div>)\n\n  }\n\n\n  // SINGLE PAGE USER AND POST OPTIONS\n  setIdForPostToBeDeleted = (id) => {\n    this.setState({ postToDelete: id })\n    this.showDelete_x()\n    console.log(this.state.postToDelete)\n\n  }\n  showDelete_x = () => {\n    this.setState({ show_x: !this.state.show_x })\n  }\n\n  render() {\n\n    const { fposts, user, userId, history, requestedLogin, picture } = this.props;\n    const { showingOne, showingUserId } = this.state\n    this.theUsers()\n    this.followeeIds()\n    this.whoImFollowing()\n\n    return (\n      <div className=\"Home-Container\">\n        <Follows />\n        <nav className=\"Homepage-nav\">\n          <ul>\n            <li id=\"jays-gram\" onClick={() => this.returnToThePost()}><span >{this.props.user}s'taGram </span>\n              <p onClick={this.appLogout} className=\"logout\" > logout  </p></li>\n\n            <li>\n              <p className=\"camera\" id={this.state.id} onClick={() => this.setState({ page: \"newPost\" })}> 📸 </p>\n            </li>\n\n\n            <li className=\"thumbnail\" onClick={() => this.setState({ page: \"profile\" })}><img src={picture} id='thumbnail' /> </li>\n\n          </ul>\n        </nav>\n\n        <div className={!localStorage.token ? \"loading \" : \"Home-Content\"}>\n\n          <div className=\"sugested-friends\">\n            {!showingOne ? <span className=\"friends-and-suggested-headers\"> Suggested</span> : null}\n            {!showingOne ? this.Suggestedfriends() : this.showOneUserBio()}\n          </div>\n\n          {!showingOne ? <div className=\"friends\">\n            <span className=\"friends-and-suggested-headers\">Friends</span>\n            {this.friends()}\n          </div> : null}\n\n          {this.pageToRender()}\n          {this.state.page !== \"newPost\" ? <div className=\"Home-footer\">Copyright &copy; 2019 Jaystagram</div> : <></>}\n        </div>\n\n      </div>\n\n\n\n    );\n  }\n\n}\nconst mapStateToProps = (state) => {\n  return {\n    user: state.users.username,\n    userid: state.users.id,\n    picture: state.users.picture,\n    users: state.users.all,\n    posts: state.post.posts,\n    requestedPost: state.post.requested,\n    requestedLogin: state.login.requested,\n    follows: state.follows.follows,\n    name: state.users.usersObj,\n  }\n}\n\nexport default connect(mapStateToProps, { getFollows, getPost, fetchAllUsers, fetchUser, addComment, editCaption, changeLike, logout, notRequesting, deleteComment, createFollow, deleteFollow })(HomeContainer);\n\n\n"]},"metadata":{},"sourceType":"module"}